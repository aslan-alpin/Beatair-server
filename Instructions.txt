1: Run server

In server folder: npm install
npm run start (or npm run dev)
Visit http://localhost:3001/auth/login and approve.
Open Spotify on the controlling account and make a device active (start any track briefly).
GET http://localhost:3001/devices to list devices.
POST http://localhost:3001/device with JSON like { "deviceId": "<your_device_id>" } to select it.
The first voting round ends at initialRoundEndsAt (default 2 minutes). After that, the top track plays. Votes for that track are reset. When it finishes, the new top track plays, and so on.

Notes

You can force-skip to the next top track with POST /skip.
This is in-memory; restarting the server clears votes and state.

2. Run client

In client folder: npm install
npm start
Open the Expo Go app on the phone and scan the QR code.
Set the Server field to your server’s LAN URL (e.g., http://192.168.1.23:3001).
Search tracks and vote.
How to use

Start the server, authorize it, and select a device.
Keep the Spotify app open on the controlling account/device so it stays active.
Open the mobile app on phones on the same LAN, set server URL, vote for tracks.
Wait for the initial round to end (default 2 minutes). The top track plays.
As each track ends, the current top-voted track plays next. The played track’s votes reset when it starts.
Notes and tweaks

You can change INITIAL_VOTING_MS in the server .env to adjust the first round length.
The server uses in-memory votes. If you want persistence, store votes in a small DB.
Playback requires a Premium account and an active device under the same account used to authorize.
For development, you can manually skip with POST /skip to test track transitions.
For LAN testing, make sure the server’s port (3001) is accessible on your network.

From the client folder, run the upgrade helper:
npx expo upgrade 54
This updates expo, react-native, and other SDK packages to the correct versions.
If the above doesn’t run, do it manually:

npm install expo@~54.0.0
npx expo install --fix (This pins react-native and other Expo packages to the right versions for SDK 54.)

Open Spotify on the same account you authorized with and start/pause any track to make the device “active”.
List devices: http://YOUR_SERVER_LAN_IP:3001/devices
Pick an id and set it: curl -X POST http://YOUR_SERVER_LAN_IP:3001/device -H "Content-Type: application/json" -d '{"deviceId":"<id>"}'
Then force-start the queue: curl -X POST http://YOUR_SERVER_LAN_IP:3001/skip If a device wasn’t selected you would see “Failed to start first track: No device selected” or “No active device found” in the server logs.
